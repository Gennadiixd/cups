(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(21),s=n.n(o),c=(n(93),n(94),n(5)),i=n.n(c),l=n(7),u=n(41),p=n(8),d=n(9),m=n(13),h=n(10),f=n(12),b=n(11),E=n(135),v=n(87),O=n(133),y=function(e,t,n,a,r,o){return{type:"ADD_COORDINATE",payload:{id:a,coordinates:e,title:t,description:n,status:r,mapCenter:o||e}}},k=function(e){return{id:e,type:"DEL_TASK_FROM_REDUCER"}},g=function(e){return{task:e,type:"ADD_TASK_TO_USER_REDUCER"}};function j(){return w.apply(this,arguments)}function w(){return(w=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/key");case 2:return t=e.sent,n=t.text(),e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=function(e){return function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/tasks/getall");case 2:return n=e.sent,e.next=5,n.json();case 5:for(a=e.sent,r=0;r<a.length;r++)t(y(a[r].coordinates[0],a[r].title,a[r].description,a[r]._id,a[r].status,[55.751574,37.573856]));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},x=function(e,t,n,a,r){return function(){var o=Object(l.a)(i.a.mark(function o(s){var c,l,u,p,d,m,h,f;return i.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if("string"!=typeof e){o.next=13;break}return o.next=3,j();case 3:return c=o.sent,o.next=6,fetch("https://geocode-maps.yandex.ru/1.x/?apikey=".concat(c,"&format=json&geocode=\u041c\u043e\u0441\u043a\u0432\u0430 ").concat(e));case 6:return l=o.sent,o.next=9,l.json();case 9:u=o.sent,e=(e=(e=u.response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos).split(" ")).reverse();case 13:return p=Number(e[0]),d=Number(e[1]),m=[p,d],console.log(m),o.next=19,fetch("/tasks/savetask",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({arrayWithCoordinates:m,title:t,description:n,expDate:a,author:r})});case 19:return h=o.sent,o.next=22,h.json();case 22:f=o.sent,s(y(m,t,n,f.id,f.status));case 24:case"end":return o.stop()}},o)}));return function(e){return o.apply(this,arguments)}}()},S=function(e){return{type:"DEL_TASK_FROM_USER_REDUCER",taskid:e}},T=function(e){return{type:"ADD_TASK_TO_REDUCER",payload:{id:e._id,coordinates:[Number(e.coordinates[0][0]),Number(e.coordinates[0][1])],title:e.title,description:e.description,status:e.status,mapCenter:[55.751574,37.573856]}}},D=function(e,t){return{type:"LOGIN_USER",user:e,tasks:t}},_=function(){var e=Object(l.a)(i.a.mark(function e(t){var n,a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return n=e.sent,e.next=5,fetch("https://geocode-maps.yandex.ru/1.x/?apikey=".concat(n,"&format=json&geocode=")+t[1]+" "+t[0]);case 5:return a=e.sent,e.next=8,a.json();case 8:return r=e.sent,e.abrupt("return",r.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),A=n(134),R=n(128),L=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={validated:!1,message:""},n.submitFormHandler=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),!1===t.currentTarget.checkValidity()?n.setState({validated:!0}):n.submitLogin(t);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.submitLogin=function(){var e=Object(l.a)(i.a.mark(function e(t){var a,r,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(u.a)(t.target.elements,2),r=a[0],o=a[1],e.next=3,fetch("/users/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:o.value,email:r.value})});case 3:return s=e.sent,e.next=6,s.json();case 6:(s=e.sent).message?n.setState({message:s.message}):(n.props.login(s.user,s.tasks),n.props.close(),n.props.placeMarksOnMap(),window.location="#/");case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.state.validated;return r.a.createElement("div",null,r.a.createElement(A.a,{noValidate:!0,validated:e,onSubmit:this.submitFormHandler},r.a.createElement(A.a.Text,{style:{color:"red"}},this.state.message),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u041f\u043e\u0447\u0442\u0430"),r.a.createElement(A.a.Control,{type:"email",required:!0}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443")),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement(A.a.Control,{type:"password",required:!0}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement(R.a,{variant:"primary",type:"submit"},"\u0412\u043e\u0439\u0442\u0438")))}}]),t}(r.a.Component),N=Object(b.b)(null,function(e){return{login:function(t,n){return e(D(t,n))},placeMarksOnMap:function(){return e(C())}}})(L),M=n(129),U=n(80),P=n(36),H=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={validated:!1,role:"",message:""},n.submitFormHandler=function(e){e.preventDefault(),!1===e.currentTarget.checkValidity()?n.setState({validated:!0}):n.submitSignUp(e)},n.submitSignUp=function(){var e=Object(l.a)(i.a.mark(function e(t){var a,r,o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(u.a)(t.target.elements,3),r=a[0],o=a[1],s=a[2],e.next=3,fetch("/users/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.value,password:s.value,email:o.value,role:n.state.role})});case 3:return c=e.sent,e.next=6,c.json();case 6:(c=e.sent).message?n.setState({message:c.message}):(n.props.login(c),n.props.close());case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.state.validated;return r.a.createElement("div",null,r.a.createElement(A.a,{noValidate:!0,validated:t,onSubmit:this.submitFormHandler},r.a.createElement(A.a.Text,{style:{color:"red"}},this.state.message),r.a.createElement(P.a,null,r.a.createElement(A.a.Label,null,"\u041b\u043e\u0433\u0438\u043d:"),r.a.createElement(A.a.Control,{type:"text",required:!0}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d")),r.a.createElement(P.a,null,r.a.createElement(A.a.Label,null,"\u041f\u043e\u0447\u0442\u0430:"),r.a.createElement(A.a.Control,{type:"email",required:!0}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"\u0410\u0434\u0440\u0435\u0441 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b - \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d")),r.a.createElement(P.a,null,r.a.createElement(A.a.Label,null,"\u041f\u0430\u0440\u043e\u043b\u044c:"),r.a.createElement(A.a.Control,{type:"password",required:!0}),r.a.createElement(A.a.Control.Feedback,{type:"invalid"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement(A.a.Label,null,"\u0420\u043e\u043b\u044c:"),r.a.createElement(P.a,{as:M.a},r.a.createElement(U.a,{sm:6},r.a.createElement(A.a.Check,{onChange:function(){return e.setState({role:"worker"})},type:"radio",name:"role",label:"\u0410\u0433\u0435\u043d\u0442",required:!0})),r.a.createElement(U.a,{sm:6},r.a.createElement(A.a.Check,{onChange:function(){return e.setState({role:"author"})},type:"radio",name:"role",label:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a"}))),r.a.createElement(R.a,{variant:"primary",type:"submit"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")))}}]),t}(r.a.Component),G=Object(b.b)(null,function(e){return{login:function(t){return e(D(t))}}})(H),F=n(34),I=n(31),B=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return this.props.user?r.a.createElement("div",null,r.a.createElement("h1",null,this.props.user.name),r.a.createElement("p",null,this.props.user.email),r.a.createElement("p",null,r.a.createElement("b",null,"\u0411\u0430\u043b\u0430\u043d\u0441:")," ",this.props.user.balance," \u0440\u0443\u0431."),r.a.createElement("p",null,r.a.createElement("b",null,"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u0439:")," ",this.props.user.statistics),r.a.createElement(I.b,{to:"/users/".concat(this.props.user.name,"/edit")},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")):r.a.createElement(F.a,{to:"/404"})}}]),t}(r.a.Component),K=Object(b.b)(function(e,t){return{user:e.auth}})(B),W=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={showLogin:!1,showRegister:!1,showProfile:!1},n.handleCloseLogin=function(){n.setState({showLogin:!1})},n.handleShowLogin=function(){n.setState({showLogin:!0})},n.handleCloseRegister=function(){n.setState({showRegister:!1})},n.handleShowRegister=function(){n.setState({showRegister:!0})},n.handleCloseProfile=function(){n.setState({showProfile:!1})},n.handleShowProfile=function(){n.setState({showProfile:!0})},n.handleLogout=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.logout(),e.next=3,fetch("users/logout");case 3:window.location="#/";case 4:case"end":return e.stop()}},e)})),n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("header",{className:"sticky-top"},r.a.createElement(E.a,{style:{background:"rgba(59,89,153 ,1 )"},variant:"dark",expand:"sm"},r.a.createElement(E.a.Brand,{href:"#home"},"cups,_____?"),r.a.createElement(E.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(E.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(v.a,{className:"mr-auto"},r.a.createElement(v.a.Link,{href:"#/users/".concat(this.props.userName)},"\u041c\u043e\u0438 \u0437\u0430\u0434\u0430\u043d\u0438\u044f")),r.a.createElement(v.a,{inline:"true",className:"mr-sm-2"},this.props.isAuth?r.a.createElement(v.a,null,r.a.createElement(v.a.Link,{onClick:this.handleShowProfile},this.props.userName),r.a.createElement(v.a.Link,{onClick:this.handleLogout},"\u0412\u044b\u0439\u0442\u0438")):r.a.createElement(v.a,null,r.a.createElement(v.a.Link,{onClick:this.handleShowRegister},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement(v.a.Link,{onClick:this.handleShowLogin},"\u0412\u043e\u0439\u0442\u0438"))))),r.a.createElement(O.a,{show:this.state.showLogin,onHide:this.handleCloseLogin},r.a.createElement(O.a.Header,{className:"modals",style:{background:"rgba(59,89,153 ,1 )"},closeButton:!0},r.a.createElement(O.a.Title,null,"\u0412\u0445\u043e\u0434")),r.a.createElement(O.a.Body,null,r.a.createElement(N,{close:this.handleCloseLogin}))),r.a.createElement(O.a,{show:this.state.showRegister,onHide:this.handleCloseRegister},r.a.createElement(O.a.Header,{className:"modals",closeButton:!0},r.a.createElement(O.a.Title,null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),r.a.createElement(O.a.Body,null,r.a.createElement(G,{close:this.handleCloseRegister}))),r.a.createElement(O.a,{show:this.state.showProfile,onHide:this.handleCloseProfile},r.a.createElement(O.a.Header,{className:"modals",closeButton:!0},r.a.createElement(O.a.Title,null,"\u041f\u0440\u043e\u0444\u0438\u043b\u044c")),r.a.createElement(O.a.Body,null,r.a.createElement(K,{close:this.handleCloseProfile}))))}}]),t}(r.a.Component),q=Object(b.b)(function(e){return{isAuth:e.auth.isAuth,userName:e.auth.name,role:e.auth.role}},function(e){return{logout:function(){e({type:"LOGOUT_USER"})}}})(W),J=n(42),z=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).componentWillReceiveProps=function(e){n.setState({address:e.address})},n.updateTitle=function(e){n.setState({title:e})},n.updateDescription=function(e){n.setState({description:e})},n.updateAddress=function(e){n.setState({address:e})},n.updateExpDate=function(e){n.setState({expDate:e})},n.state={title:"",description:"",address:"",expDate:""},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"createTask",value:function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.props.fetchCoordinates(this.state.address,t.target.title.value,t.target.description.value,t.target.expDate.value,this.props.name);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"task col-lg-4"},r.a.createElement(A.a,{style:{paddingTop:"10px"},onSubmit:function(t){return e.createTask(t)}},r.a.createElement(A.a.Text,{style:{textAlign:"center"},as:"h5"},"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u0410\u0434\u0440\u0435\u0441: "),r.a.createElement(A.a.Control,{type:"text",name:"address",value:this.state.address,onChange:function(t){return e.updateAddress(t.target.value)},required:!0})),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435: "),r.a.createElement(A.a.Control,{type:"text",name:"title",value:this.state.title,onChange:function(t){return e.updateTitle(t.target.value)},required:!0})),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e \u043e\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u0443\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u044f: "),r.a.createElement(A.a.Control,{className:"noResize",as:"textarea",rows:"5",type:"text-field",name:"description",value:this.state.description,onChange:function(t){return e.updateDescription(t.target.value)},required:!0})),r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0434\u043e: "),r.a.createElement(A.a.Control,{type:"datetime-local",name:"expDate",value:this.state.expDate,onChange:function(t){return e.updateExpDate(t.target.value)},required:!0})),r.a.createElement(A.a.Group,null,r.a.createElement(R.a,{variant:"primary",type:"submit"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))))}}]),t}(r.a.Component),$=Object(b.b)(function(e,t){return{name:e.auth.name}},function(e){return{fetchCoordinates:function(t,n,a,r,o){return arguments.length>5&&void 0!==arguments[5]&&arguments[5],e(x(t,n,a,r,o))}}})(z),V=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={value:null},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"sendId",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/tasks/take",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({taskId:this.props.match.params.id,userName:this.props.auth})});case 2:return t=e.sent,e.next=5,t.json();case 5:"empty"!==(n=e.sent).respond&&this.props.takeTask(n.taskID,n.task),window.location="#/";case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.sendId(),r.a.createElement("div",null)}}]),t}(r.a.Component),Y=Object(b.b)(function(e){return{auth:e.auth.name,reducerTaskId:e.maps.coordinates}},function(e){return{delTaskFromReducer:function(t){return e(k(t))},takeTask:function(t,n){return e(function(e,t){return function(){var n=Object(l.a)(i.a.mark(function n(a){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a(k(e));case 2:return n.next=4,a(g(t));case 4:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}()}(t,n))}}})(V),Q=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(F.d,null,r.a.createElement(F.b,{path:"/tasks/:id",component:Y}))}}]),t}(r.a.Component),X=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"col-lg-6 info"},r.a.createElement("h5",null,"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b\u043e\u043c \u0441\u0435\u0440\u0432\u0438\u0441\u0430, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0438\u043b\u0438 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c."))}}]),t}(r.a.Component),Z=n(137),ee=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={},n.submitFormHandler=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("/tasks/complete",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n.props.id,report:t.target.elements[0].value})});case 3:n.props.makeTaskPending(n.props.id),n.props.close();case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.submitLogin=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(A.a,{onSubmit:this.submitFormHandler},r.a.createElement(A.a.Group,null,r.a.createElement(A.a.Label,null,"\u041e\u0442\u0447\u0451\u0442"),r.a.createElement(A.a.Control,{as:"textarea",className:"noResize",rows:"5",type:"text-field",required:!0})),r.a.createElement(R.a,{variant:"primary",type:"submit"},"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c")))}}]),t}(r.a.Component),te=Object(b.b)(null,function(e){return{login:function(t,n){return e(D(t,n))},placeMarksOnMap:function(){return e(C())},makeTaskPending:function(t){return e(function(e){return{type:"MAKE_TASK_PENDING",id:e}}(t))}}})(ee),ne=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={showComplete:!1,taskid:""},n.discardTaskHandler=function(){var e=Object(l.a)(i.a.mark(function e(t,a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/tasks/discardtask",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})});case 2:n.props.refresh(t,a);case 3:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n.handleCloseComplete=function(){n.setState({showComplete:!1})},n.handleShow=function(e){n.setState({showComplete:!0}),n.setState({taskid:e})},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.tasks.filter(function(e){return"pending"!==e.status});return r.a.createElement("div",{className:"task col-lg-4"},0!==t.length?r.a.createElement("h5",{style:{textAlign:"center"}},"\u0422\u0435\u043a\u0443\u0449\u0438\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f"):r.a.createElement("h5",{style:{textAlign:"center"}},"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439"),r.a.createElement("br",null),t.map(function(t,n){return r.a.createElement(Z.a,{key:t._id+t.title},r.a.createElement(Z.a.Header,{as:"h5"},n+1,". ",t.title),r.a.createElement(Z.a.Body,null,r.a.createElement(Z.a.Text,null,t.description),r.a.createElement(R.a,{variant:"primary",onClick:function(){return e.handleShow(t._id)}},"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c"),r.a.createElement(R.a,{variant:"danger",onClick:function(){return e.discardTaskHandler(t._id,t)}},"\u041e\u0442\u043a\u0430\u0437\u0430\u0442\u044c\u0441\u044f")))}),r.a.createElement(O.a,{show:this.state.showComplete,onHide:this.handleCloseComplete},r.a.createElement(O.a.Header,{className:"modals",style:{background:"rgba(59,89,153 ,1 )"},closeButton:!0},r.a.createElement(O.a.Title,null,"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u0435")),r.a.createElement(O.a.Body,null,r.a.createElement(te,{id:this.state.taskid,close:this.handleCloseComplete}))))}}]),t}(r.a.Component),ae=Object(b.b)(function(e,t){return{name:e.auth.name,tasks:e.auth.tasks}},function(e){return{refresh:function(t,n){return e(function(e,t){return function(n){n(S(e)),n(T(t))}}(t,n))}}})(ne),re=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).updateWindowDimensions=function(){n.setState({width:window.innerWidth,height:window.innerHeight})},n.placeMark=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,n.setState({center:n.props.coordinates[n.props.coordinates.length-1].coordinates});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.inputHandler=function(){var e=Object(l.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({input:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.updateInput=function(e){n.setState({input:e})},n.state={input:"",center:[55.751574,37.573856],zoom:9,width:0,height:0,hint:[],address:""},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillMount",value:function(){var e=Object(l.a)(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.placeMarksOnMap();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t={center:this.state.center,zoom:this.state.zoom};return r.a.createElement("div",null,r.a.createElement("div",{className:"yMap"},r.a.createElement(J.YMaps,null,r.a.createElement("div",null,r.a.createElement(J.Map,{onClick:function(){var t=Object(l.a)(i.a.mark(function t(n){var a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("author"!==e.props.role){t.next=9;break}return t.next=3,e.setState({hint:n.get("coords")});case 3:return t.next=5,e.props.convertCoordinatesToAddress(n.get("coords"));case 5:return a=t.sent,r=a.replace(/^(.*),(.*), (.*), (.*)/,"$3 $4, $2"),t.next=9,e.setState({address:r});case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),width:this.state.width,height:this.state.height,defaultState:t,state:{center:this.props.coordinates[this.props.coordinates.length-1].mapCenter,zoom:this.state.zoom}},"author"===this.props.role?this.state.hint&&r.a.createElement(J.Placemark,{onDragEnd:function(){var t=Object(l.a)(i.a.mark(function t(n){var a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({hint:n.originalEvent.target.geometry._coordinates}),t.next=3,e.props.convertCoordinatesToAddress(n.originalEvent.target.geometry._coordinates);case 3:return a=t.sent,r=a.replace(/^(.*),(.*), (.*), (.*)/,"$3 $4, $2"),t.next=7,e.setState({address:r});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),onClick:function(e){console.log(e.get("coords"))},geometry:this.state.hint,properties:{balloonContentHeader:"",balloonContentBody:"",balloonContentFooter:""},modules:["geoObject.addon.hint"],options:{preset:"islands#redDotIconWithCaption",draggable:!0}}):null,this.props.isAuth&&this.props.coordinates.map(function(t){return r.a.createElement(J.Placemark,{key:t.id,geometry:t.coordinates,properties:{balloonContentHeader:"".concat(t.title),balloonContentBody:"".concat(t.description),balloonContentFooter:"worker"===e.props.role?"<a href = '#tasks/".concat(t.id,"'>\u0412\u0437\u044f\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435</a>"):"author"===e.props.role&&"pending"===t.status?"<h7>\u0437\u0430\u0434\u0430\u0438\u043d\u0438\u0435 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f</h7>":"<h7>\u0437\u0430\u0434\u0430\u0438\u043d\u0438\u0435 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f</h7>"},modules:["geoObject.addon.balloon","geoObject.addon.hint"],options:{preset:"pending"!==t.status?"default":"islands#yellowCircleDotIcon"}})}),this.props.ownTasks&&this.props.ownTasks.map(function(t){return r.a.createElement(J.Placemark,{key:t._id+"111",geometry:t.coordinates[0],properties:{balloonContentHeader:"".concat(t.title),balloonContentBody:"".concat(t.description),balloonContentFooter:"worker"===e.props.role?"pending"!==t.status?'<h7>"\u042d\u0442\u043e \u0432\u0430\u0448\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435"</h7>':'<h7>"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435"</h7>':null},modules:["geoObject.addon.balloon","geoObject.addon.hint"],options:{preset:"pending"!==t.status?"islands#greenDotIconWithCaption":"islands#yellowCircleDotIcon"}})}))))),r.a.createElement(Q,null),this.props.isAuth?"author"===this.props.role?r.a.createElement($,{address:this.state.address}):r.a.createElement(ae,null):r.a.createElement(X,null))}}]),t}(r.a.Component),oe=Object(b.b)(function(e){return{coordinates:e.maps.coordinates,isAuth:e.auth.isAuth,ownTasks:e.auth.tasks,role:e.auth.role}},function(e){return{fetchCoordinates:function(t){return e(x(t))},placeMarksOnMap:function(){return e(C())},convertCoordinatesToAddress:function(e){return _(e)}}})(re),se=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Page is not found"))},ce=function(e){function t(){return Object(p.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(this.props.match.url),e.next=3,fetch(this.props.match.url,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:this.props.role})});case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,console.log(n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,"CompletedTasksByExecutor")}}]),t}(r.a.Component),ie=Object(b.b)(function(e,t){return{name:e.auth.name,role:e.auth.role}})(ce),le=n(130),ue=n(131);var pe=function(e){return r.a.createElement("div",null,r.a.createElement(le.a,{fluid:!0,style:{padding:"10px","margin-bottom":"5px"}},r.a.createElement(ue.a,null,r.a.createElement("h1",null,e.item.title),r.a.createElement("p",null,e.item.description),r.a.createElement("p",null,"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 ",e.item.prettyDate))))},de=n(136),me=n(132),he=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(m.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={activeTasks:[],completedTasks:[]},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.props.match.url,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:this.props.name,role:this.props.role})});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,console.log(n),e.next=9,this.setState({activeTasks:n.active,completedTasks:n.completed});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.activeTasks.map(function(e){return r.a.createElement(pe,{key:e._id,item:e})}),t=this.state.completedTasks.map(function(e){return r.a.createElement(pe,{key:e._id,item:e})});return this.props.name?r.a.createElement(de.a,{defaultActiveKey:"active",id:"uncontrolled-tab-example"},r.a.createElement(me.a,{eventKey:"active",title:"\u0422\u0435\u043a\u0443\u0449\u0438\u0435"},e),r.a.createElement(me.a,{eventKey:"completed",title:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"},t)):r.a.createElement(F.a,{to:"/404"})}}]),t}(r.a.Component),fe=Object(b.b)(function(e,t){return{name:e.auth.name,role:e.auth.role}})(he),be=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={user:{}},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("main",null,r.a.createElement(F.d,null,r.a.createElement(F.b,{exact:!0,path:"/users/:name",render:function(t){return e.props.isAuth&&"worker"===e.props.role?r.a.createElement(ie,t):r.a.createElement(fe,t)}}),r.a.createElement(F.b,{path:"/",component:oe}),r.a.createElement(F.b,{exact:!0,path:"/404",component:se})))}}]),t}(r.a.Component),Ee=Object(b.b)(function(e,t){return{isAuth:e.auth.isAuth,role:e.auth.role}})(be);var ve=Object(b.b)(function(e){return{isAuth:e.auth.isAuth,userName:e.auth.username}},function(e){return{logout:function(){return e({type:"LOGOUT_USER"})},login:function(t,n){return e(D(t,n))}}})(function(e){var t=Object(a.useState)({checked:!1}),n=Object(u.a)(t,2),o=n[0],s=n[1];return Object(a.useEffect)(function(){function t(){return(t=Object(l.a)(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/users/check");case 3:return n=t.sent,t.next=6,n.json();case 6:n=t.sent,s({checked:!0}),!1!==n&&e.login(n.user,n.tasks),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log("Connection to server Failed");case 14:case"end":return t.stop()}},t,null,[[0,11]])}))).apply(this,arguments)}o.checked||e.isAuth||function(){t.apply(this,arguments)}()},[e,o]),r.a.createElement("div",{className:"App"},r.a.createElement(q,null),r.a.createElement(Ee,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Oe=n(27),ye=n(85),ke=n(26),ge={coordinates:[{mapCenter:[55.751574,37.573856],id:1}]},je=n(66),we={isAuth:!1,tasks:[]},Ce=Object(Oe.combineReducers)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_USER":return Object(je.a)({},t.user,{tasks:t.tasks?t.tasks:[],isAuth:!0});case"LOGOUT_USER":return{isAuth:!1};case"ADD_TASK_TO_USER_REDUCER":return Object.assign({},e,{tasks:[].concat(Object(ke.a)(e.tasks),[t.task])});case"DEL_TASK_FROM_USER_REDUCER":return Object.assign({},e,{activeTasks:Object(ke.a)(e.activeTasks.filter(function(e){return e!==t.taskid}))},{tasks:Object(ke.a)(e.tasks.filter(function(e){return e._id!==t.taskid}))});case"MAKE_TASK_PENDING":return Object.assign({},e,{tasks:Object(ke.a)(e.tasks.map(function(e){return t.id===e._id?Object(je.a)({},e,{status:"pending"}):e}))});default:return e}},maps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COORDINATE":return Object.assign({},e,{coordinates:[].concat(Object(ke.a)(e.coordinates),[t.payload])});case"DEL_TASK_FROM_REDUCER":return Object.assign({},e,{coordinates:Object(ke.a)(e.coordinates.filter(function(e){return e.id!==t.id}))});case"ADD_TASK_TO_REDUCER":return Object.assign({},e,{coordinates:[].concat(Object(ke.a)(e.coordinates),[t.payload])});case"LOGOUT_USER":return{coordinates:[{mapCenter:[55.751574,37.573856],id:1}]};default:return e}}}),xe=n(86),Se=Object(ye.composeWithDevTools)({}),Te=Object(Oe.createStore)(Ce,Se(Object(Oe.applyMiddleware)(xe.a)));s.a.render(r.a.createElement(b.a,{store:Te},r.a.createElement(I.a,null,r.a.createElement(ve,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},88:function(e,t,n){e.exports=n(127)},93:function(e,t,n){}},[[88,1,2]]]);
//# sourceMappingURL=main.90a2b249.chunk.js.map